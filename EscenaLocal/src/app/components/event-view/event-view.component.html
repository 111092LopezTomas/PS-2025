<div *ngIf="loading" class="container my-5">
  <div class="text-center py-5">
    <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <p class="mt-3 text-muted">Cargando evento...</p>
  </div>
</div>

<!-- Estado de Error -->
<div *ngIf="error && !loading" class="container my-5">
  <div class="alert alert-danger d-flex align-items-center" role="alert">
    <i class="bi bi-exclamation-triangle-fill fs-4 me-3"></i>
    <div class="flex-grow-1">
      <h5 class="alert-heading">Error al cargar el evento</h5>
      <p class="mb-0">{{ error }}</p>
    </div>
    <button class="btn btn-outline-danger" (click)="reintentar()">
      <i class="bi bi-arrow-clockwise me-2"></i>Reintentar
    </button>
  </div>
</div>

<!-- Contenido del Evento -->
<div *ngIf="evento && !loading" class="container my-5">
  <div class="row">
    <!-- Imagen Principal -->
    <div class="col-lg-6 mb-4">
      <div class="event-image-container">
        <img [src]="apiBase + '/eventos/' + evento.id + '/imagen'" class="img-fluid rounded shadow-lg">
        <span class="badge bg-danger position-absolute top-0 end-0 m-3" 
              *ngIf="evento.entradasDetalle.disponibilidad < 100">
          ¡Pocas entradas!
        </span>
      </div>
    </div>

    <!-- Información del Evento -->
    <div class="col-lg-6">
      <div class="event-header mb-4">
        <span class="badge bg-primary mb-2">{{ evento.genero }}</span>
        <h1 class="display-4 fw-bold mb-3">{{ evento.evento }}</h1>
        <h3 class="text-muted mb-4">{{ evento.artistas }}</h3>
      </div>

      <!-- Detalles Principales -->
      <div class="event-details-card bg-light rounded p-4 mb-4">
        <div class="row g-3">
          <div class="col-md-6">
            <div class="d-flex align-items-center">
              <i class="bi bi-calendar-event fs-4 text-primary me-3"></i>
              <div>
                <small class="text-muted d-block">Fecha</small>
                <strong>{{ evento.fecha }}</strong>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="d-flex align-items-center">
              <i class="bi bi-clock fs-4 text-primary me-3"></i>
              <div>
                <small class="text-muted d-block">Hora</small>
                <strong>{{ evento.hora }}</strong>
              </div>
            </div>
          </div>
          <div class="col-12">
            <div class="d-flex align-items-center">
              <i class="bi bi-geo-alt fs-4 text-primary me-3"></i>
              <div>
                <small class="text-muted d-block">Ubicación</small>
                <strong>{{ evento.establecimiento }}</strong>
                <p class="mb-0 text-muted small">{{ evento.direccion }}, {{evento.ciudad}}, {{evento.provincia}}</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Precio y Compra -->
      <div class="pricing-section bg-dark text-white rounded p-4 mb-4">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <small class="d-block opacity-75">Precio por entrada</small>
            <h2 class="mb-0 fw-bold">${{ evento.entradasDetalle.precio }}</h2>
          </div>
          <button class="btn btn-warning btn-lg px-5" 
                  (click)="comprarEntrada()"
                  [disabled]="evento.disponibilidad === 0">
            <i class="bi bi-ticket-perforated me-2"></i>
            {{ evento.disponibilidad > 0 ? 'Comprar' : 'Agotado' }}
          </button>
        </div>
        <div class="mt-3">
          <small class="text-warning" *ngIf="evento.disponibilidad > 0">
            ⚠ Solo {{ evento.disponibilidad }} entradas disponibles
          </small>
          <small class="text-danger" *ngIf="evento.disponibilidad === 0">
            ❌ Entradas agotadas
          </small>
        </div>
      </div>

      <!-- Botones de Acción
      <div class="d-flex gap-2">
        <button class="btn btn-outline-primary flex-grow-1" (click)="compartirEvento()">
          <i class="bi bi-share me-2"></i>Compartir
        </button>
        <button class="btn btn-outline-secondary">
          <i class="bi bi-heart"></i>
        </button>
      </div> -->
    </div>
  </div>

  <!-- Descripción y Destacados -->
  <div class="row mt-5">
    <div class="col-lg-8">
      <div class="description-section">
        <h4 class="fw-bold mb-3">Acerca del Evento</h4>
        <p class="lead text-muted">{{ evento.descripcion }}</p>
        
        <div class="mt-4">
          <span class="badge bg-secondary me-2">
            <i class="bi bi-hourglass-split me-1"></i>{{ evento.duracion }}
          </span>
          <span class="badge bg-secondary">
            <i class="bi bi-people me-1"></i>Capacidad: {{ evento.capacidad }} personas
          </span>
        </div>
      </div>
    </div>

    <div class="col-lg-4">
      <div class="highlights-section bg-light rounded p-4">
        <h5 class="fw-bold mb-3">Destacados</h5>
        <ul class="list-unstyled">
          <li *ngFor="let destacado of evento.destacados" class="mb-2">
            <i class="bi bi-check-circle-fill text-success me-2"></i>
            {{ destacado }}
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>